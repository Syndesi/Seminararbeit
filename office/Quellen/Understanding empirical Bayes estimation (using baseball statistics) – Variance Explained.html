<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class=" js no-touch rgba hsla textshadow opacity svg" style="" lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Understanding empirical Bayes estimation (using baseball statistics) – Variance Explained</title>
<meta name="description" content="Which of these two proportions is higher: 4 out of 10, or 300 out of 1000? This sounds like a silly question. Obviously , which is greater than .

">
<meta name="keywords" content="r, statistics, education">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Understanding empirical Bayes estimation (using baseball statistics)">
<meta name="twitter:description" content="Which of these two proportions is higher: 4 out of 10, or 300 out of 1000? This sounds like a silly question. Obviously , which is greater than .

">
<meta name="twitter:site" content="@drob">
<meta name="twitter:creator" content="@drob">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://varianceexplained.org/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Understanding empirical Bayes estimation (using baseball statistics)">
<meta property="og:description" content="Which of these two proportions is higher: 4 out of 10, or 300 out of 1000? This sounds like a silly question. Obviously , which is greater than .

">
<meta property="og:url" content="http://varianceexplained.org/r/empirical_bayes_baseball/">
<meta property="og:site_name" content="Variance Explained">





<link rel="canonical" href="http://varianceexplained.org/r/empirical_bayes_baseball/">
<link href="http://varianceexplained.org/feed.xml" type="application/atom+xml" rel="alternate" title="Variance Explained Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://varianceexplained.org/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://varianceexplained.org/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script async="" src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/analytics.js"></script><script src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/modernizr-2.js"></script>

<!-- MathJax -->
<script src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/MathJax.js" id="">
</script>

<link href="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/css.css" rel="stylesheet" type="text/css">

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://varianceexplained.org/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://varianceexplained.org/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://varianceexplained.org/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://varianceexplained.org/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://varianceexplained.org/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://varianceexplained.org/images/apple-touch-icon-144x144-precomposed.png">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57723549-1', 'auto');
  ga('send', 'pageview');
</script>



<script type="text/javascript" async="" src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/embed.js"></script><script async="" type="text/javascript" src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/count.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><link rel="preload" as="style" href="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/a_data/lounge.css"><link rel="preload" as="script" href="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/a_data/common.js"><link rel="preload" as="script" href="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/a_data/lounge.js"><link rel="preload" as="script" href="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/a_data/config.js"><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/alfie.js" async="" charset="UTF-8"></script></head>

<body class="post"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://varianceexplained.org/">Variance Explained</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav"><button type="button" role="button" id="menutoggle" class="navtoogle navicon-lines-button x" aria-hidden="true"><span class="navicon-lines"></span>menu</button>
		    <ul>
		        
					    
					    <li><a href="http://varianceexplained.org/about/">About Me</a></li>
					  
					    
					    <li><a href="http://varianceexplained.org/posts/">Posts</a></li>
					  
					    
					    <li><a href="http://varianceexplained.org/RData/">R Course</a></li>
					  
					    
					    <li><a href="http://varianceexplained.org/r/empirical-bayes-book/">Introduction to Empirical Bayes</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    


	<img src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/david_robinson_picture2.jpg" class="bio-photo" alt="David Robinson bio photo">

<h3>David Robinson</h3>
<p>Data Scientist at Stack Overflow, works in R and Python.</p>
<a href="mailto:drobinson@stackoverflow.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>
<a href="http://twitter.com/drob" class="author-social" target="_blank"><i class="fa fa-twitter-square"></i> Twitter</a>





<a href="http://github.com/dgrtwo" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>
<a href="http://stackoverflow.com/users/712603" class="author-social" target="_blank"><i class="fa fa-stack-overflow"></i> Stack Overflow</a>






<h4>Subscribe</h4>

<form method="post" action="http://blogtrottr.com">
    <input name="btr_email" placeholder="Your email" type="text"><br>
    <input name="btr_url" value="http://varianceexplained.org/feed.xml" type="hidden">
    <input name="schedule_type" value="0" type="hidden">
    <input class="styled-button-4" value="Subscribe to this blog" type="submit">
</form>

<style type="text/css"> 
.styled-button-4 {
	-webkit-box-shadow:rgba(0,0,0,0.98) 0 1px 0 0;
	-moz-box-shadow:rgba(0,0,0,0.98) 0 1px 0 0;
	box-shadow:rgba(0,0,0,0.98) 0 1px 0 0;
	background-color:#EEE;
	border-radius:0;
	-webkit-border-radius:0;
	-moz-border-radius:0;
	border:1px solid #999;
	color:#666;
	font-family:'Lucida Grande',Tahoma,Verdana,Arial,Sans-serif;
	font-size:11px;
	font-weight:700;
	padding:2px 6px;
	height:28px
}
</style>


<h4>Recommended Blogs</h4>
<ul>
    <li><a href="https://www.datacamp.com/community/blog">DataCamp</a></li>
    <li><a href="http://www.r-bloggers.com/">R Bloggers</a></li>
    <li><a href="http://blog.rstudio.org/">RStudio Blog</a></li>
    <li><a href="http://r4stats.com/">R4Stats</a></li>
    <li><a href="http://simplystatistics.org/">Simply Statistics</a></li>
</ul>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://varianceexplained.org/r/empirical_bayes_baseball/" rel="bookmark" title="Understanding empirical Bayes estimation (using baseball statistics)">Understanding empirical Bayes estimation (using baseball statistics)</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>Which of these two proportions is higher: <strong>4 out of 10</strong>, or <strong>300 out of 1000</strong>? This sounds like a silly question. Obviously <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;.4&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.095em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1004.07em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">4</span><span class="texatom" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-7" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.278em;">.4</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>10</mn><mo>=</mo><mn>.4</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">4/10=.4</script>, which is greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;300&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;.3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 7.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.142em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1006.1em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mn" id="MathJax-Span-12" style="font-family: MathJax_Main;">300</span><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-16" style="font-family: MathJax_Main;">1000</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.278em;">.3</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>300</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>1000</mn><mo>=</mo><mn>.3</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">300/1000=.3</script>.</p>

<p>But suppose you were a baseball recruiter, trying to decide which of 
two potential players is a better batter based on how many hits they 
get. One has achieved 4 hits in 10 chances, the other 300 hits in 1000 
chances. While the first player has a higher proportion of hits, it’s 
not a lot of evidence: a typical player tends to achieve a hit around 
27% of the time, and this player’s <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 2.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1001.95em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mn" id="MathJax-Span-21" style="font-family: MathJax_Main;">4</span><span class="texatom" id="MathJax-Span-22"><span class="mrow" id="MathJax-Span-23"><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">4/10</script> could be due to luck. The second player, on the other hand, has a lot of evidence that he’s an above-average batter.</p>

<p>This post isn’t really about baseball, I’m just using it as an illustrative example. (I actually know very little about <a href="https://en.wikipedia.org/wiki/Sabermetrics">sabermetrics</a>. If you want a more technical version of this post, check out <a href="https://projecteuclid.org/euclid.imsc/1288099025">this great paper</a>). This post is, rather, about a very useful statistical method for estimating a large number of proportions, called <strong>empirical Bayes estimation</strong>. It’s to help you with data that looks like this:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Success</th>
      <th style="text-align: right">Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">11</td>
      <td style="text-align: right">104</td>
    </tr>
    <tr>
      <td style="text-align: right">82</td>
      <td style="text-align: right">1351</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: right">26</td>
    </tr>
    <tr>
      <td style="text-align: right">0</td>
      <td style="text-align: right">40</td>
    </tr>
    <tr>
      <td style="text-align: right">1203</td>
      <td style="text-align: right">7592</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: right">166</td>
    </tr>
  </tbody>
</table>

<p>A lot of data takes the form of these success/total counts, where you
 want to estimate a “proportion of success” for each instance. Each row 
might represent:</p>

<ul>
  <li><strong>An ad you’re running</strong>: Which of your ads have 
higher clickthrough rates, and which have lower? (Note that I’m not 
talking about running an A/B test comparing two options, but rather 
about ranking and analyzing a large list of choices.)</li>
  <li><strong>A user on your site</strong>: In my work at Stack Overflow, I might look at what fraction of a user’s visits are to Javascript questions, to <a href="http://kevinmontrose.com/2015/01/27/providence-machine-learning-at-stack-exchange/">guess whether they are a web developer</a>.
 In another application, you might consider how often a user decides to 
read an article they browse over, or to purchase a product they’ve 
clicked on.</li>
</ul>

<p>When you work with pairs of successes/totals like this, you tend to get tripped up by the uncertainty in low counts. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.509em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1001.46em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-32" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">1/2</script> does not mean the same thing as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33" style="width: 3.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.017em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1002.98em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-34"><span class="mn" id="MathJax-Span-35" style="font-family: MathJax_Main;">50</span><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-39" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>50</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">50/100</script>; nor does <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-40" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.509em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1001.44em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="mn" id="MathJax-Span-42" style="font-family: MathJax_Main;">0</span><span class="texatom" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-46" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">0/1</script> mean the same thing as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 3.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.017em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1002.98em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mn" id="MathJax-Span-49" style="font-family: MathJax_Main;">0</span><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-53" style="font-family: MathJax_Main;">1000</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>1000</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">0/1000</script>.
 One approach is to filter out all cases that don’t meet some minimum, 
but this isn’t always an option: you’re throwing away useful 
information.</p>

<p>I previously wrote a post about one approach to this problem, using the same analogy: <a href="http://varianceexplained.org/statistics/beta_distribution_and_baseball/">Understanding the beta distribution (using baseball statistics)</a>. Using the beta distribution to represent your <em>prior expectations</em>, and <em>updating</em>
 based on the new evidence, can help make your estimate more accurate 
and practical. Now I’ll demonstrate the related method of empirical 
Bayes estimation, where the beta distribution is used to improve a large
 set of estimates. What’s great about this method is that as long as you
 have a lot of examples, <em>you don’t need to  bring in prior expectations</em>.</p>

<p>Here I’ll apply empirical Bayes estimation to a baseball dataset, 
with the goal of improving our estimate of each player’s batting 
average. I’ll focus on the intuition of this approach, but will also 
show the R code for running this analysis yourself. (So that the post 
doesn’t get cluttered, I don’t show the code for the graphs and tables, 
only the estimation itself. But you can find <em>all</em> this post’s code <a href="https://github.com/dgrtwo/dgrtwo.github.com/blob/master/_R/">here</a>).</p>

<h3 id="working-with-batting-averages">Working with batting averages</h3>

<p>In my <a href="http://varianceexplained.org/statistics/beta_distribution_and_baseball/">original post about the beta distribution</a>,
 I made some vague guesses about the distribution of batting averages 
across history, but here we’ll work with real data. We’ll use the <code class="highlighter-rouge">Batting</code> dataset from the excellent <a href="https://cran.r-project.org/web/packages/Lahman/index.html">Lahman package</a>. We’ll prepare and clean the data a little first, using dplyr and tidyr:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">Lahman</span><span class="p">)</span><span class="w">

</span><span class="n">career</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Batting</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">AB</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">anti_join</span><span class="p">(</span><span class="n">Pitching</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"playerID"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">playerID</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">H</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">H</span><span class="p">),</span><span class="w"> </span><span class="n">AB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">AB</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">average</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">AB</span><span class="p">)</span><span class="w">

</span><span class="c1"># use names along with the player IDs
</span><span class="n">career</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Master</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">tbl_df</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">playerID</span><span class="p">,</span><span class="w"> </span><span class="n">nameFirst</span><span class="p">,</span><span class="w"> </span><span class="n">nameLast</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">unite</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">nameFirst</span><span class="p">,</span><span class="w"> </span><span class="n">nameLast</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" "</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">inner_join</span><span class="p">(</span><span class="n">career</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"playerID"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">playerID</span><span class="p">)</span></code></pre></figure>

<p>Above, we filtered out pitchers (generally the weakest batters, who 
should be analyzed separately). We summarized each player across 
multiple years to get their <em>career</em> Hits (H) and At Bats (AB), 
and batting average. Finally, we added first and last names to the 
dataset, so we could work with them rather than an identifier:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">career</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Source: local data frame [9,256 x 4]
## 
##                 name     H    AB average
##                (chr) (int) (int)   (dbl)
## 1         Hank Aaron  3771 12364  0.3050
## 2       Tommie Aaron   216   944  0.2288
## 3          Andy Abad     2    21  0.0952
## 4        John Abadie    11    49  0.2245
## 5     Ed Abbaticchio   772  3044  0.2536
## 6        Fred Abbott   107   513  0.2086
## 7        Jeff Abbott   157   596  0.2634
## 8        Kurt Abbott   523  2044  0.2559
## 9         Ody Abbott    13    70  0.1857
## 10 Frank Abercrombie     0     4  0.0000
## ..               ...   ...   ...     ...</code></pre></figure>

<p>I wonder who the best batters in history were. Well, here are the ones with the highest batting average:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: right">H</th>
      <th style="text-align: right">AB</th>
      <th style="text-align: right">average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Jeff Banister</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Doc Bass</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Steve Biras</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">C. B. Burns</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left">Jackie Gallagher</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">1</td>
    </tr>
  </tbody>
</table>

<p>Err, that’s not really what I was looking for. These aren’t the best 
batters, they’re just the batters who went up once or twice and got 
lucky. How about the worst batters?</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: right">H</th>
      <th style="text-align: right">AB</th>
      <th style="text-align: right">average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Frank Abercrombie</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">4</td>
      <td style="text-align: right">0</td>
    </tr>
    <tr>
      <td style="text-align: left">Horace Allen</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">7</td>
      <td style="text-align: right">0</td>
    </tr>
    <tr>
      <td style="text-align: left">Pete Allen</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">4</td>
      <td style="text-align: right">0</td>
    </tr>
    <tr>
      <td style="text-align: left">Walter Alston</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">0</td>
    </tr>
    <tr>
      <td style="text-align: left">Bill Andrus</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">0</td>
    </tr>
  </tbody>
</table>

<p>Also not what I was looking for. That “average” is a really crummy estimate. <strong>Let’s make a better one.</strong></p>

<h3 id="step-1-estimate-a-prior-from-all-your-data">Step 1: Estimate a prior from all your data</h3>

<p>Let’s look at the distribution of batting averages across players.</p>

<p><img src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/unnamed-chunk-7-1.png" alt="center"></p>

<p>(For the sake of estimating the prior distribution, I’ve filtered out
 all players that have fewer than 500 at-bats, since we’ll get a better 
estimate from the less noisy cases. I show a more principled approach in
 the Appendix).</p>

<p>The first step of empirical Bayes estimation is to estimate a beta 
prior using this data. Estimating priors from the data you’re currently 
analyzing is not the typical Bayesian approach- usually you decide on 
your priors ahead of time. There’s a lot of debate and discussion about 
when and where it’s appropriate to use empirical Bayesian methods, but 
it basically comes down to how many observations we have: if we have a 
lot, we can get a good estimate that doesn’t depend much on any one 
individual. Empirical Bayes is an <strong>approximation</strong> to more exact Bayesian methods- and with the amount of data we have, it’s a very good approximation.</p>

<p>So far, a beta distribution looks like a pretty appropriate choice 
based on the above histogram. (What would make it a bad choice? Well, 
suppose the histogram had two peaks, or three, instead of one. Then we 
might need a <a href="https://en.wikipedia.org/wiki/Mixture_model">mixture of Betas</a>, or an even more complicated model). So we know we want to fit the following model:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;Beta&lt;/mtext&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-54" style="width: 8.785em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.543em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1007.45em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main; padding-left: 0.278em;">∼</span><span class="mstyle" id="MathJax-Span-58" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-59"><span class="mtext" id="MathJax-Span-60" style="font-family: MathJax_Main;">Beta</span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-66" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.57em, 4.343em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.566em;"><span class="mn" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>∼</mo><mstyle displaystyle="false" scriptlevel="0"><mtext>Beta</mtext></mstyle><mo stretchy="false">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">X\sim\mbox{Beta}(\alpha_0,\beta_0)</script>

<p>We just need to pick <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-70" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.821em, 1001.08em, 2.752em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-71"><span class="msubsup" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.255em; border-left: 0px solid; width: 0px; height: 0.83em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">\alpha_0</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-75" style="width: 1.134em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.97em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.558em, 1000.97em, 2.78em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-76"><span class="msubsup" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.57em, 4.343em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.566em;"><span class="mn" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.288em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">\beta_0</script>, which we call “hyper-parameters” of our model. There are many methods in R for fitting a probability distribution to data (<code class="highlighter-rouge">optim</code>, <code class="highlighter-rouge">mle</code>, <code class="highlighter-rouge">bbmle</code>, etc). You don’t even have to use maximum likelihood: you could <a href="http://stats.stackexchange.com/questions/12232">use the mean and variance</a>, called the “method of moments”. But we’ll use the <a href="http://www.inside-r.org/r-doc/MASS/fitdistr">fitdistr</a> function from MASS.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># just like the graph, we have to filter for the players we actually
# have a decent estimate of
</span><span class="n">career_filtered</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">career</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">filter</span><span class="p">(</span><span class="n">AB</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">

</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">MASS</span><span class="o">::</span><span class="n">fitdistr</span><span class="p">(</span><span class="n">career_filtered</span><span class="o">$</span><span class="n">average</span><span class="p">,</span><span class="w"> </span><span class="n">dbeta</span><span class="p">,</span><span class="w">
                    </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">shape1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">shape2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w">

</span><span class="n">alpha0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">m</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
</span><span class="n">beta0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">m</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">2</span><span class="p">]</span></code></pre></figure>

<p>This comes up with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;78.661&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 6.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.172em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.587em, 1005.1em, 2.752em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="msubsup" id="MathJax-Span-82"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.278em;">78.661</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.255em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mn>0</mn></msub><mo>=</mo><mn>78.661</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">\alpha_0=78.661</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;224.875&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-87" style="width: 6.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.603em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.558em, 1005.55em, 2.78em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-88"><span class="msubsup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.57em, 4.343em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.566em;"><span class="mn" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.278em;">224.875</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.288em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mn>224.875</mn></math></span></span><script type="math/tex" id="MathJax-Element-12">\beta_0=224.875</script>. How well does this fit the data?</p>

<p><img src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/unnamed-chunk-8-1.png" alt="center"></p>

<p>Not bad! Not perfect, but something we can work with.</p>

<h3 id="step-2-use-that-distribution-as-a-prior-for-each-individual-estimate">Step 2: Use that distribution as a prior for each individual estimate</h3>

<p>Now when we look at any individual to estimate their batting average, we’ll start with our overall prior, and <a href="https://en.wikipedia.org/wiki/Bayesian_inference">update</a> based on the individual evidence. I went over this process in detail in the <a href="http://stats.stackexchange.com/questions/47771/what-is-the-intuition-behind-beta-distribution">original Beta distribution post</a>: it’s as simple as adding <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-94" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.821em, 1001.08em, 2.752em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-95"><span class="msubsup" id="MathJax-Span-96"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.255em; border-left: 0px solid; width: 0px; height: 0.83em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">\alpha_0</script> to the number of hits, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-99" style="width: 3.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.558em, 1003.29em, 2.78em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-105" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.57em, 4.343em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.566em;"><span class="mn" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.288em; border-left: 0px solid; width: 0px; height: 1.168em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">\alpha_0 + \beta_0</script> to the total number of at-bats.</p>

<p>For example, consider our hypothetical batter from the introduction 
that went up 1000 times, and got 300 hits. We would estimate his batting
 average as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;300&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;300&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;78.7&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;78.7&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;224.9&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.29&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-108" style="width: 23.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.205em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.91em, 1020.16em, 3.466em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-109"><span class="mfrac" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 6.627em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.159em, 1003.79em, 4.314em, -1000em); top: -4.664em; left: 50%; margin-left: -1.895em;"><span class="mrow" id="MathJax-Span-111"><span class="mn" id="MathJax-Span-112" style="font-family: MathJax_Main;">300</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-114" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.12em, 1006.51em, 4.343em, -1000em); top: -3.301em; left: 50%; margin-left: -3.254em;"><span class="mrow" id="MathJax-Span-117"><span class="mn" id="MathJax-Span-118" style="font-family: MathJax_Main;">1000</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-120" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-124" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.57em, 4.343em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.566em;"><span class="mn" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1006.63em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.627em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-128" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 8.62em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.149em, 1004.48em, 4.231em, -1000em); top: -4.664em; left: 50%; margin-left: -2.25em;"><span class="mrow" id="MathJax-Span-129"><span class="mn" id="MathJax-Span-130" style="font-family: MathJax_Main;">300</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.222em;">78.7</span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.148em, 1008.46em, 4.231em, -1000em); top: -3.301em; left: 50%; margin-left: -4.25em;"><span class="mrow" id="MathJax-Span-133"><span class="mn" id="MathJax-Span-134" style="font-family: MathJax_Main;">1000</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.222em;">78.7</span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.222em;">224.9</span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1008.62em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.62em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-140" style="font-family: MathJax_Main; padding-left: 0.278em;">0.29</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.083em; border-left: 0px solid; width: 0px; height: 2.715em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mn>300</mn><mo>+</mo><msub><mi>α</mi><mn>0</mn></msub></mrow><mrow><mn>1000</mn><mo>+</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>300</mn><mo>+</mo><mn>78.7</mn></mrow><mrow><mn>1000</mn><mo>+</mo><mn>78.7</mn><mo>+</mo><mn>224.9</mn></mrow></mfrac><mo>=</mo><mn>0.29</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">\frac{300+\alpha_0}{1000+\alpha_0+\beta_0}=\frac{300+78.7}{1000+78.7+224.9}=0.29</script>

<p>How about the batter who went up only 10 times, and got 4 hits. We would estimate his batting average as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;78.7&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;78.7&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;224.9&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.264&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 21.716em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.696em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.909em, 1018.67em, 3.466em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mfrac" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 5.627em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.148em, 1002.79em, 4.314em, -1000em); top: -4.664em; left: 50%; margin-left: -1.395em;"><span class="mrow" id="MathJax-Span-144"><span class="mn" id="MathJax-Span-145" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.12em, 1005.51em, 4.343em, -1000em); top: -3.301em; left: 50%; margin-left: -2.754em;"><span class="mrow" id="MathJax-Span-150"><span class="mn" id="MathJax-Span-151" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-153" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.383em, 1000.6em, 4.16em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.64em;"><span class="mn" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-157" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.57em, 4.343em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.566em;"><span class="mn" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1005.63em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.627em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-161" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 7.62em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.148em, 1003.48em, 4.231em, -1000em); top: -4.664em; left: 50%; margin-left: -1.75em;"><span class="mrow" id="MathJax-Span-162"><span class="mn" id="MathJax-Span-163" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.222em;">78.7</span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.148em, 1007.46em, 4.231em, -1000em); top: -3.301em; left: 50%; margin-left: -3.75em;"><span class="mrow" id="MathJax-Span-166"><span class="mn" id="MathJax-Span-167" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-169" style="font-family: MathJax_Main; padding-left: 0.222em;">78.7</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.222em;">224.9</span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1007.62em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.62em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-173" style="font-family: MathJax_Main; padding-left: 0.278em;">0.264</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.083em; border-left: 0px solid; width: 0px; height: 2.716em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mn>4</mn><mo>+</mo><msub><mi>α</mi><mn>0</mn></msub></mrow><mrow><mn>10</mn><mo>+</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>4</mn><mo>+</mo><mn>78.7</mn></mrow><mrow><mn>10</mn><mo>+</mo><mn>78.7</mn><mo>+</mo><mn>224.9</mn></mrow></mfrac><mo>=</mo><mn>0.264</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">\frac{4+\alpha_0}{10+\alpha_0+\beta_0}=\frac{4+78.7}{10+78.7+224.9}=0.264</script>

<p>Thus, even though <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;300&lt;/mn&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-174" style="width: 4.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.203em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.365em, 1004.2em, 2.984em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-175"><span class="mfrac" id="MathJax-Span-176"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.347em, 1000.33em, 4.149em, -1000em); top: -4.398em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.354em, 1000.68em, 4.164em, -1000em); top: -3.605em; left: 50%; margin-left: -0.354em;"><span class="mn" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1000.83em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.827em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;</span><span class="mfrac" id="MathJax-Span-180" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.534em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.354em, 1001.03em, 4.164em, -1000em); top: -4.414em; left: 50%; margin-left: -0.53em;"><span class="mn" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Main;">300</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.354em, 1001.39em, 4.164em, -1000em); top: -3.605em; left: 50%; margin-left: -0.707em;"><span class="mn" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Main;">1000</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1001.53em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.534em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.524em; border-left: 0px solid; width: 0px; height: 1.627em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>4</mn><mn>10</mn></mfrac><mo>&gt;</mo><mfrac><mn>300</mn><mn>1000</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-17">\frac{4}{10}>\frac{300}{1000}</script>, we would guess that the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;300&lt;/mn&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-183" style="width: 2.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.778em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.365em, 1001.78em, 2.984em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-184"><span class="mfrac" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 1.534em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.354em, 1001.03em, 4.164em, -1000em); top: -4.414em; left: 50%; margin-left: -0.53em;"><span class="mn" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">300</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.354em, 1001.39em, 4.164em, -1000em); top: -3.605em; left: 50%; margin-left: -0.707em;"><span class="mn" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">1000</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1001.53em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.534em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.524em; border-left: 0px solid; width: 0px; height: 1.627em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>300</mn><mn>1000</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-18">\frac{300}{1000}</script> batter is better than the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-188" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.373em, 1001.08em, 2.984em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-189"><span class="mfrac" id="MathJax-Span-190"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.347em, 1000.33em, 4.149em, -1000em); top: -4.398em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.354em, 1000.68em, 4.164em, -1000em); top: -3.605em; left: 50%; margin-left: -0.354em;"><span class="mn" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1000.83em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.827em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.524em; border-left: 0px solid; width: 0px; height: 1.618em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>4</mn><mn>10</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-19">\frac{4}{10}</script> batter!</p>

<p>Performing this calculation for all the batters is simple enough:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">career_eb</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">career</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">mutate</span><span class="p">(</span><span class="n">eb_estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">H</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alpha0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">AB</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">alpha0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta0</span><span class="p">))</span></code></pre></figure>

<h3 id="results">Results</h3>

<p>Now we can ask: who are the best batters by this improved estimate?</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: right">H</th>
      <th style="text-align: right">AB</th>
      <th style="text-align: right">average</th>
      <th style="text-align: right">eb_estimate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Rogers Hornsby</td>
      <td style="text-align: right">2930</td>
      <td style="text-align: right">8173</td>
      <td style="text-align: right">0.358</td>
      <td style="text-align: right">0.355</td>
    </tr>
    <tr>
      <td style="text-align: left">Shoeless Joe Jackson</td>
      <td style="text-align: right">1772</td>
      <td style="text-align: right">4981</td>
      <td style="text-align: right">0.356</td>
      <td style="text-align: right">0.350</td>
    </tr>
    <tr>
      <td style="text-align: left">Ed Delahanty</td>
      <td style="text-align: right">2596</td>
      <td style="text-align: right">7505</td>
      <td style="text-align: right">0.346</td>
      <td style="text-align: right">0.343</td>
    </tr>
    <tr>
      <td style="text-align: left">Billy Hamilton</td>
      <td style="text-align: right">2158</td>
      <td style="text-align: right">6268</td>
      <td style="text-align: right">0.344</td>
      <td style="text-align: right">0.340</td>
    </tr>
    <tr>
      <td style="text-align: left">Harry Heilmann</td>
      <td style="text-align: right">2660</td>
      <td style="text-align: right">7787</td>
      <td style="text-align: right">0.342</td>
      <td style="text-align: right">0.339</td>
    </tr>
  </tbody>
</table>

<p>Who are the <em>worst</em> batters?</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: right">H</th>
      <th style="text-align: right">AB</th>
      <th style="text-align: right">average</th>
      <th style="text-align: right">eb_estimate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Bill Bergen</td>
      <td style="text-align: right">516</td>
      <td style="text-align: right">3028</td>
      <td style="text-align: right">0.170</td>
      <td style="text-align: right">0.178</td>
    </tr>
    <tr>
      <td style="text-align: left">Ray Oyler</td>
      <td style="text-align: right">221</td>
      <td style="text-align: right">1265</td>
      <td style="text-align: right">0.175</td>
      <td style="text-align: right">0.191</td>
    </tr>
    <tr>
      <td style="text-align: left">John Vukovich</td>
      <td style="text-align: right">90</td>
      <td style="text-align: right">559</td>
      <td style="text-align: right">0.161</td>
      <td style="text-align: right">0.196</td>
    </tr>
    <tr>
      <td style="text-align: left">John Humphries</td>
      <td style="text-align: right">52</td>
      <td style="text-align: right">364</td>
      <td style="text-align: right">0.143</td>
      <td style="text-align: right">0.196</td>
    </tr>
    <tr>
      <td style="text-align: left">George Baker</td>
      <td style="text-align: right">74</td>
      <td style="text-align: right">474</td>
      <td style="text-align: right">0.156</td>
      <td style="text-align: right">0.196</td>
    </tr>
  </tbody>
</table>

<p>Notice that in each of these cases, empirical Bayes didn’t simply 
pick the players who had 1 or 2 at-bats. It found players who batted 
well, or poorly, across a long career. What a load off our minds: we can
 start using these empirical Bayes estimates in downstream analyses and 
algorithms, and not worry that we’re accidentally letting <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-193" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.509em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1001.44em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-194"><span class="mn" id="MathJax-Span-195" style="font-family: MathJax_Main;">0</span><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-199" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">0/1</script> or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-200" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.509em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.513em, 1001.44em, 2.836em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-201"><span class="mn" id="MathJax-Span-202" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-203"><span class="mrow" id="MathJax-Span-204"><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-206" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.352em; border-left: 0px solid; width: 0px; height: 1.285em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">1/1</script> cases ruin everything.</p>

<p>Overall, let’s see how empirical Bayes changed all of the batting average estimates:</p>

<p><img src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/unnamed-chunk-11-1.png" alt="center"></p>

<p>The horizontal dashed red line marks <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.259&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 9.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.813em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.422em, 1007.77em, 3.169em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-211" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.129em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.513em, 1000.76em, 4.266em, -1000em); top: -4.515em; left: 50%; margin-left: -0.378em;"><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0.756em; height: 0px;"><span style="position: absolute; clip: rect(3.513em, 1000.43em, 4.156em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.881em; left: 0.453em;"><span class="mn" id="MathJax-Span-214" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(3.327em, 1002.01em, 4.322em, -1000em); top: -3.578em; left: 50%; margin-left: -1.004em;"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 0.756em; height: 0px;"><span style="position: absolute; clip: rect(3.513em, 1000.43em, 4.156em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.881em; left: 0.453em;"><span class="mn" id="MathJax-Span-218" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span><span class="mo" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.327em, 1000.41em, 4.286em, -1000em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.005em;"></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; top: -3.825em; left: 0.4em;"><span class="mn" id="MathJax-Span-222" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.987em;"></span></span><span style="position: absolute; clip: rect(0.849em, 1002.13em, 1.239em, -1000em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.129em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-224" style="font-family: MathJax_Main; padding-left: 0.278em;">0.259</span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.738em; border-left: 0px solid; width: 0px; height: 1.776em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mfrac><msub><mi>α</mi><mn>0</mn></msub><mrow><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub></mrow></mfrac><mo>=</mo><mn>0.259</mn></math></span></span><script type="math/tex" id="MathJax-Element-22">y=\frac{\alpha_0}{\alpha_0 + \beta_0}=0.259</script>- that’s what we would guess someone’s batting average was if we had <em>no</em> evidence at all. Notice that points above that line tend to move down towards it, while points below it move up.</p>

<p>The diagonal red line marks <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-225" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.425em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.821em, 1002.42em, 2.791em, -1000em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.425em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.3em; border-left: 0px solid; width: 0px; height: 0.876em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">x=y</script>.
 Points that lie close to it are the ones that didn’t get shrunk at all 
by empirical Bayes. Notice that they’re the ones with the highest number
 of at-bats (the brightest blue): they have enough evidence that we’re 
willing to believe the naive batting average estimate.</p>

<p>This is why this process is sometimes called <em>shrinkage</em>: 
we’ve moved all our estimates towards the average. How much it moves 
these estimates depends on how much evidence we have: if we have very 
little evidence (4 hits out of 10) we move it a lot, if we have a lot of
 evidence (300 hits out of 1000) we move it only a little. That’s 
shrinkage in a nutshell: <em>Extraordinary outliers require extraordinary evidence</em>.</p>

<h3 id="conclusion-so-easy-it-feels-like-cheating">Conclusion: So easy it feels like cheating</h3>

<p>Recall that there were two steps in empirical Bayes estimation:</p>

<ol>
  <li>Estimate the overall distribution of your data.</li>
  <li>Use that distribution as your prior for estimating each average.</li>
</ol>

<p>Step 1 can be done once, “offline”- analyze all your data and come up
 with some estimates of your overall distribution. Step 2 is done for 
each new observation you’re considering. You might be estimating the 
success of a post or an ad, or classifying the behavior of a user in 
terms of how often they make a particular choice.</p>

<p>And because we’re using the beta and the binomial, consider how <em>easy</em>
 that second step is. All we did was add one number to the successes, 
and add another number to the total. You can build that into your 
production system with a single line of code that takes nanoseconds to 
run.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>// We hired a Data Scientist to analyze our Big Data
// and all we got was this lousy line of code.
float estimate = (successes + 78.7) / (total + 303.5);
</code></pre>
</div>

<p>That really is so simple that it feels like cheating- like the kind 
of “fudge factor” you might throw into your code, with the intention of 
coming back to it later to do some real Machine Learning.</p>

<p>I bring this up to disprove the notion that statistical 
sophistication necessarily means dealing with complicated, burdensome 
algorithms. This Bayesian approach is based on sound principles, but 
it’s still easy to implement. Conversely, next time you think “I only 
have time to implement a dumb hack,” remember that you can use methods 
like these: it’s a way to choose your fudge factor. Some dumb hacks are 
better than others!</p>

<p>But when anyone asks what you did, remember to call it “empirical 
Bayesian shrinkage towards a Beta prior.” We statisticians have to keep 
up appearances.</p>

<h3 id="appendix-how-could-we-make-this-more-complicated">Appendix: How could we make this more complicated?</h3>

<p>We’ve made some enormous simplifications in this post. For one thing,
 we assumed all batting averages are drawn from a single distribution. 
In reality, we’d expect that it depends on some known factors. For 
instance, the distribution of batting averages has changed over time:</p>

<p><img src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/unnamed-chunk-12-1.png" alt="center"></p>

<p>Ideally, we’d want to estimate a different Beta prior for each 
decade. Similarly, we could estimate separate priors for each team, a 
separate prior for pitchers, and so on. One useful approach to this is <a href="https://en.wikipedia.org/wiki/Bayesian_hierarchical_modeling">Bayesian hierarchical modeling</a> (as used in, for example, <a href="http://andrewgelman.com/2014/01/21/everything-need-know-bayesian-statistics-learned-eight-schools/">this study of SAT scores across different schools</a>).</p>

<p>Also, as alluded to above, we shouldn’t be estimating the 
distribution of batting averages using only the ones with more than 500 
at-bats. Really, we should use all of our data to estimate the 
distribution, but give <em>more consideration</em> to the players with a
 higher number of at-bats. This can be done by fitting a beta-binomial 
distribution. For instance, we can use the <a href="http://www.inside-r.org/packages/cran/VGAM/docs/Betabinom">dbetabinom.ab</a> function from VGAM, and the <code class="highlighter-rouge">mle</code> function:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">VGAM</span><span class="p">)</span><span class="w">

</span><span class="c1"># negative log likelihood of data given alpha; beta
</span><span class="n">ll</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dbetabinom.ab</span><span class="p">(</span><span class="n">career</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">career</span><span class="o">$</span><span class="n">AB</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L-BFGS-B"</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## alpha  beta 
##    75   222</code></pre></figure>

<p>We end up getting almost the same prior, which is reassuring!</p>

      <hr>
      <footer role="contentinfo">
        <div class="article-author-bottom">
          


	<img src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/david_robinson_picture2.jpg" class="bio-photo" alt="David Robinson bio photo">

<h3>David Robinson</h3>
<p>Data Scientist at Stack Overflow, works in R and Python.</p>
<a href="mailto:drobinson@stackoverflow.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>
<a href="http://twitter.com/drob" class="author-social" target="_blank"><i class="fa fa-twitter-square"></i> Twitter</a>





<a href="http://github.com/dgrtwo" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>
<a href="http://stackoverflow.com/users/712603" class="author-social" target="_blank"><i class="fa fa-stack-overflow"></i> Stack Overflow</a>






<h4>Subscribe</h4>

<form method="post" action="http://blogtrottr.com">
    <input name="btr_email" placeholder="Your email" type="text"><br>
    <input name="btr_url" value="http://varianceexplained.org/feed.xml" type="hidden">
    <input name="schedule_type" value="0" type="hidden">
    <input class="styled-button-4" value="Subscribe to this blog" type="submit">
</form>

<style type="text/css"> 
.styled-button-4 {
	-webkit-box-shadow:rgba(0,0,0,0.98) 0 1px 0 0;
	-moz-box-shadow:rgba(0,0,0,0.98) 0 1px 0 0;
	box-shadow:rgba(0,0,0,0.98) 0 1px 0 0;
	background-color:#EEE;
	border-radius:0;
	-webkit-border-radius:0;
	-moz-border-radius:0;
	border:1px solid #999;
	color:#666;
	font-family:'Lucida Grande',Tahoma,Verdana,Arial,Sans-serif;
	font-size:11px;
	font-weight:700;
	padding:2px 6px;
	height:28px
}
</style>


<h4>Recommended Blogs</h4>
<ul>
    <li><a href="https://www.datacamp.com/community/blog">DataCamp</a></li>
    <li><a href="http://www.r-bloggers.com/">R Bloggers</a></li>
    <li><a href="http://blog.rstudio.org/">RStudio Blog</a></li>
    <li><a href="http://r4stats.com/">R4Stats</a></li>
    <li><a href="http://simplystatistics.org/">Simply Statistics</a></li>
</ul>

        </div>
        <p class="byline"><strong>Understanding empirical Bayes estimation (using baseball statistics)</strong> was published on <time datetime="2015-10-01T00:00:00+00:00">October 01, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"><iframe id="dsq-app4688" name="dsq-app4688" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 1px !important; min-width: 100% !important; border: medium none !important; overflow: hidden !important; height: 7131px !important;" src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/a.html" horizontalscrolling="no" verticalscrolling="no" frameborder="0" width="100%"></iframe></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://varianceexplained.org/posts/">View all posts</a>)</small></h4>
    <ul>
    
    </ul>
    <hr>
  </div><!-- /.related-articles -->
  <footer>
    

<span>© 2017 David Robinson. Powered by <a href="http://jekyllrb.com/">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/jquery.js"></script>
<script>window.jQuery || document.write('<script src="http://varianceexplained.org/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="Understanding%20empirical%20Bayes%20estimation%20(using%20baseball%20statistics)%20%E2%80%93%20Variance%20Explained-Dateien/scripts.js"></script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'varianceexplained'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


	        


<iframe style="display: none;"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: italic; font-size-adjust: none; font-family: MathJax_Math,sans-serif;"></div></div></body></html>